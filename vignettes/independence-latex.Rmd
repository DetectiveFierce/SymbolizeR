---
title: "Independence & LaTeX Export"
output: 
  rmarkdown::html_vignette:
    css: vignette-theme.css
    includes:
      after_body: vignette-extras.html
vignette: >
  %\VignetteIndexEntry{Independence & LaTeX Export}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = FALSE,
  comment = "#>"
)
```

This vignette covers two advanced features: **declaring independence** between random variables, and **exporting results to LaTeX** for homework and publications.

```{r setup}
library(SymbolizeR)
```

---

## Independence Assumptions

### The Product Wall

By default, SymbolizeR cannot simplify products of random variables:

```{r no-independence}
E(X * Y)
```

This is mathematically correctâ€”without knowing the relationship between X and Y, we cannot factor $E[XY]$.

### Breaking the Wall with `assume.independent()`

When you know that random variables are independent, declare it:

```{r declare-independence}
assume.independent(X, Y)
E(X * Y)  # Now factors!
```

For independent variables: $E[XY] = E[X] \cdot E[Y]$

### Mutual Independence

Declare multiple variables as mutually independent:

```{r mutual-independence}
assume.independent(A, B, C)

# All pairwise products now factor
E(A * B)
E(B * C)
E(A * C)
```

### Managing Independence

View current assumptions:

```{r show-independence}
show.independence()
```

Clear all assumptions:

```{r clear-independence}
clear.independence()
E(X * Y)  # Back to unsimplified form
```

---

## Independence with Distributions

Combined with `define()`, independence enables powerful simplifications:

```{r independence-distributions}
# Define distributions
define(X ~ Normal(mu_x, sigma_x))
define(Y ~ Normal(mu_y, sigma_y))

# Without independence
Cov(X, Y)

# With independence
assume.independent(X, Y)
E(X * Y)  # Becomes mu_x * mu_y

clear.independence()
clear.definitions()
```

---

## LaTeX Export

### Converting Expressions

The `to.latex()` function converts R expressions to publication-ready LaTeX:

```{r latex-basic}
to.latex(quote(E(X)))
to.latex(quote(Var(X)))
to.latex(quote(Cov(X, Y)))
```

### Greek Letters

Greek letters are automatically converted:

```{r latex-greek}
to.latex(quote(mu + sigma^2))
to.latex(quote(alpha * beta))
```

### Fractions and Powers

```{r latex-fractions}
to.latex(quote(a / b))
to.latex(quote(x^2 + y^2))
```

### Complex Expressions

```{r latex-complex}
# Variance formula
to.latex(quote(E(X^2) - E(X)^2))

# With Greek letters
to.latex(quote(sigma^2 + mu^2))
```

### From Function Results

Apply `to.latex()` directly to results:
```{r latex-results}
result <- E(a * X + b)
to.latex(result)
```

---

## Derivations to LaTeX

Convert step-by-step derivations for homework:

```{r latex-derivation, eval=FALSE}
deriv <- derive.E(a * X + b)
to.latex(deriv)
```

This produces an `align*` environment showing each step:

```
\begin{align*}
  E[a * X + b] &= ... && \text{(Starting expression)}
  &= ... && \text{(Apply expectation rules)}
  ...
\end{align*}
```

For just the final answer:

```{r latex-final}
deriv <- derive.E(a * X + b)
to.latex(deriv, align = FALSE)
```

---

## Workflow Example

Complete workflow for a homework problem:

```{r workflow}
# 1. Define distributions
define(X ~ Normal(mu, sigma))

# 2. Compute symbolically
variance_result <- Var(X)
variance_result

# 3. Export to LaTeX
to.latex(variance_result)

# Cleanup
clear.definitions()
```

Copy the LaTeX output directly into your document!

---

## Function Reference

| Function | Purpose |
|----------|---------|
| `assume.independent(...)` | Declare variables as mutually independent |
| `show.independence()` | Display current independence assumptions |
| `clear.independence()` | Remove all independence assumptions |
| `to.latex(expr)` | Convert expression to LaTeX string |
| `to.latex(deriv, align=TRUE)` | Convert derivation to align environment |

<div class="vignette-nav">
  <a href="calculus.html" class="nav-item prev">
    <span class="nav-label">Previous</span>
    <span class="nav-title">4. Calculus</span>
  </a>
  <a href="internals.html" class="nav-item next">
    <span class="nav-label">Next</span>
    <span class="nav-title">6. Package Internals</span>
  </a>
</div>

